<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Cat Clicker Game</title>
  <style>
    body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background-color: #f0f8ff;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}

.container {
  text-align: center;
}

#cat {
  width: 200px;
  height: auto;
  cursor: pointer;
  transition: transform 0.1s;
}

.leaderboard {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(255,255,255,0.9);
  padding: 10px;
  border-radius: 8px;
  max-width: 200px;
}

.leaderboard h2 {
  margin-top: 0;
  font-size: 18px;
}

.leaderboard ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.leaderboard li {
  margin-bottom: 5px;
  font-size: 14px;
}

.scoreboard {
  position: absolute;
  top: 20px;
  left: 20px;
  background: rgba(255,255,255,0.9);
  padding: 10px;
  border-radius: 8px;
}

.scoreboard h3 {
  margin: 0;
  font-size: 16px;
}
  </style>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <div class="leaderboard" id="leaderboard">
    <h2>Leaderboard</h2>
    <ul id="leaderboard-list">
      <!-- Leaderboard entries will be populated here -->
    </ul>
  </div>
  
  <div class="scoreboard">
    <h3>Your Score: <span id="score">0</span></h3>
  </div>
  
  <div class="container">
    <img src="images/cat-closed.png" alt="Cat" id="cat">
  </div>
  
  <script>
    // Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyDzku7AoSdbF7GzZTJEtVj5beyl1MnrTAk",
    authDomain: "minecraft-generators.firebaseapp.com",
    databaseURL: "https://minecraft-generators-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "minecraft-generators",
    storageBucket: "minecraft-generators.appspot.com",
    messagingSenderId: "191346462383",
    appId: "1:191346462383:web:6c8759e5ee2f676594ce5a",
    measurementId: "G-QJT1XPTPDZ"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// DOM Elements
const cat = document.getElementById('cat');
const scoreDisplay = document.getElementById('score');
const leaderboardList = document.getElementById('leaderboard-list');

let score = 0;

// Get User's Country
let userCountry = 'Unknown';

fetch('https://ipapi.co/json/')
  .then(response => response.json())
  .then(data => {
    userCountry = data.country_name || 'Unknown';
  })
  .catch(error => {
    console.error('Error fetching country:', error);
  });

// Update Personal Score Display
function updateScoreDisplay() {
  scoreDisplay.textContent = score;
}

// Handle Cat Click Events
cat.addEventListener('mousedown', (e) => {
  if (e.button === 0) { // Left click
    cat.src = 'images/cat-open.png';
    incrementScore();
  }
});

cat.addEventListener('mouseup', (e) => {
  if (e.button === 0) { // Left click
    cat.src = 'images/cat-closed.png';
  }
});

// Increment Score and Update Firebase
function incrementScore() {
  score += 1;
  updateScoreDisplay();
  
  // Update Personal Score
  database.ref('users/' + getUserId()).set({
    score: score,
    country: userCountry,
    timestamp: Date.now()
  });
}

// Generate a Unique User ID (simple version)
function getUserId() {
  let userId = localStorage.getItem('userId');
  if (!userId) {
    userId = 'user_' + Date.now() + '_' + Math.floor(Math.random() * 1000);
    localStorage.setItem('userId', userId);
  }
  return userId;
}

// Listen for leaderboard updates
database.ref('users').on('value', (snapshot) => {
  const users = snapshot.val();
  const leaderboard = {};

  for (let userId in users) {
    const user = users[userId];
    if (user.country in leaderboard) {
      leaderboard[user.country] += user.score;
    } else {
      leaderboard[user.country] = user.score;
    }
  }

  // Convert leaderboard object to sorted array
  const sortedLeaderboard = Object.entries(leaderboard).sort((a, b) => b[1] - a[1]);

  // Populate leaderboard UI
  leaderboardList.innerHTML = '';
  sortedLeaderboard.forEach(([country, totalScore]) => {
    const li = document.createElement('li');
    li.textContent = `${country}: ${totalScore}`;
    leaderboardList.appendChild(li);
  });
});
  </script>
</body>
</html>